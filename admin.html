// Function to create a new user (admin-only)
function createNewUser() {
    const userName = document.getElementById('newUserName').value.trim();
    const userLocation = document.getElementById('newUserLocation').value;
    const userGender = document.getElementById('newUserGender').value;

    if (!userName) {
        alert("Por favor, ingrese un nombre.");
        return;
    }

    console.log("Attempting to create new user:", { userName, userLocation, userGender });

    const newUserRef = database.ref('users').push();
    newUserRef.set({
        name: userName,
        location: userLocation,
        gender: userGender,
        points: 0
    }).then(() => {
        alert("Nuevo usuario creado correctamente.");
        console.log("User created successfully:", userName);
        loadAdminData();
    }).catch(error => {
        console.error("Error al crear el usuario:", error);
        alert("Error al crear el usuario. Consulte la consola para más detalles.");
    });
}

// Function to load admin data
function loadAdminData() {
    console.log("Loading user data from Firebase...");
    const usersRef = database.ref('users');

    usersRef.once('value', (snapshot) => {
        const adminUserList = document.getElementById('adminUserList');
        adminUserList.innerHTML = '';

        if (!snapshot.exists()) {
            console.warn("No user data found.");
            return;
        }

        console.log("Data snapshot:", snapshot.val());

        snapshot.forEach(userSnapshot => {
            const user = userSnapshot.val();
            console.log("User loaded:", user);
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${user.name}</td>
                <td>${user.location}</td>
                <td>${user.gender}</td>
                <td>${user.points}</td>
                <td><button onclick="editUser('${userSnapshot.key}')">Editar</button></td>
            `;
            adminUserList.appendChild(row);
        });
        console.log("Admin data loaded successfully.");
    }).catch(error => {
        console.error("Error al cargar los datos de administrador:", error);
        alert("Error al cargar los datos de administrador. Consulte la consola para más detalles.");
    });
}
